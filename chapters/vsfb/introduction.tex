\usepackage{hyperref}
\usepackage{longtable}

\chapter{Introduction}
\label{ch:introduction}

\section{Introduction Outline}

\textit{Preamble: Below is roughly the narrative direction I'm thinking for the introduction. Of course, a lot of details need to be filled in, but I try to outline the flow as best I can.}

The distribution and survival of invertebrate species are governed by a complex interplay of biotic and abiotic factors. For many insects, abiotic conditions such as temperature, humidity, and wind can be primary drivers of behavior, physiology, and habitat selection. Wind, in particular, can influence everything from dispersal and migration to foraging efficiency and predation risk.

The monarch butterfly (\textit{Danaus plexippus}) presents an excellent system for studying these dynamics. Its diverse life history, which includes distinct breeding and overwintering phases, exposes it to a unique suite of environmental challenges. As a charismatic and threatened species, understanding the factors that limit monarch populations is not only of scientific interest but also critical for effective conservation.

The overwintering stage, when monarchs form dense aggregations in coastal California and central Mexico, is a period of immense physiological stress where abiotic factors are paramount. During this time, the "microclimate hypothesis" suggests that monarchs select groves that provide a specific suite of conditions necessary for survival: protection from freezing temperatures, access to moisture, dappled sunlight for thermal regulation, and shelter from wind.

Foundational work by Kingston Leong has been central to our understanding of monarch overwintering needs, specifically identifying wind as a key determinant of habitat suitability. Leong (2016) posits that winds exceeding 2 m/s are "disruptive," causing butterflies to be either physically dislodged from their roosts or induced to flee. Such disruption is considered detrimental as it can force the butterflies to expend critical energy reserves needed to survive the winter and may increase their exposure to predation. This assertion directly informs our choice of response variable: the change in monarch abundance at a roost.

Leong's understanding of wind's impact has been highly influential, forming the basis for management guidelines by organizations like the Xerces Society. However, his conclusions were largely inferred from comparing wind measurements at occupied roost trees versus unoccupied trees, rather than from direct observation of butterfly behavioral responses to wind. In contrast to Leong's methods, this study uses direct, continuous time-series observation of behavioral responses within a single, occupied roost. To our knowledge, this relationship has never been directly and empirically tested.

Furthermore, to isolate the effect of wind, we must also account for other environmental drivers. Monarchs are ectotherms that rely on solar radiation to warm their bodies for flight. Exposure to sunlight is therefore a primary driver of activity and can trigger dispersal as individuals leave the roost to forage for nectar, seek water, or find mates. Therefore, to accurately test the disruptive wind hypothesis, we must statistically control for the confounding effects of sunlight exposure and ambient temperature. We include these as an interaction term because the effect of solar radiation on a butterfly's body temperature is not independent of the ambient temperature. Direct sunlight provides the primary thermal energy for flight, but the amount of warming required to reach a flight threshold is lower on a warm day than on a cold one, making the effects of these two variables inherently interconnected.

While this 2 m/s threshold provides a critical starting point, the nature of wind is complex. Its disruptive force may be a function of not just a single speed but also its consistency (sustained wind) and turbulence (gustiness). Therefore, a comprehensive test of the disruptive wind hypothesis requires examining these different wind characteristics.

\section{Hypothesis and Proposed Analysis}

\subsection{Wind Dispersal Hypothesis}

Based on the mechanistic framework established by Leong (2016), we hypothesize that disruptive wind events cause monarch butterflies to abandon their roosts, leading to a measurable decrease in local abundance. We predict that exposure to wind speeds exceeding the 2 m/s threshold will be negatively correlated with changes in monarch abundance at a roost.

\subsection{A Sequential Three-Step Analysis}

To test this hypothesis, we propose a three-step analytical framework designed to first test the specific, established threshold and then, if necessary, explore the relationship more broadly.

\subsubsection{Step 1: Direct Test of the 2 m/s Threshold}

Our first step is a direct test of Leong's hypothesis using Generalized Linear Mixed-Effects Models (GLMMs). To properly model our count-based abundance index and account for likely overdispersion, we will use a negative binomial distribution. The response variable will be the `abundance_index` at time t, a metric representing the sum of conservative butterfly estimates within the sampled image. To account for temporal dependency, we will include the `abundance_index` from the previous time step (t-1) as a covariate. We will create two predictor variables representing the number of minutes that sustained and gust wind speeds exceed the 2 m/s threshold and test them in separate models to avoid issues with collinearity.

\begin{verbatim}
% Load required library
library(lme4)

# Model 1: Test sustained wind threshold with Negative Binomial GLMM
model_sustained_threshold <- glmer(
    abundance_index_t ~ abundance_index_t_minus_1 + 
                        sustained_minutes_above_2ms + 
                        sunlight_exposure_prop * ambient_temp +
                        (1 | view/labeler),
    family = "nbinom2",
    data = monarch_data
)

# Model 2: Test gust wind threshold with Negative Binomial GLMM
model_gust_threshold <- glmer(
    abundance_index_t ~ abundance_index_t_minus_1 + 
                        gust_minutes_above_2ms + 
                        sunlight_exposure_prop * ambient_temp +
                        (1 | view/labeler),
    family = "nbinom2",
    data = monarch_data
)
\end{verbatim}

If either analysis reveals a significant negative relationship, it would provide strong empirical support for the 2 m/s threshold. If not, as we suspect, it would suggest the relationship is more complex, leading us to the next step.

\subsubsection{Step 2: General Wind-Abundance Relationship Model}

If the specific 2 m/s threshold is not a strong predictor, we will broaden our inquiry to test whether wind, in a more general sense, influences monarch abundance. While I initially wanted to model the change in abundance directly, this approach creates a response variable with a complex and non-standard statistical distribution, making model interpretation unreliable. To overcome this, I propose we use a more robust method by modeling the abundance_index at each time step directly within a Generalized Linear Mixed-Effects Model (GLMM) framework, using a negative binomial distribution that is commonly used for count data.

A key challenge in analyzing time-series data is that the number of butterflies at any given moment is highly dependent on the number present just before. To properly account for this, our model will include the abundance from the previous time step (abundance_index_t_minus_1) as a predictor variable. By doing so, the model effectively asks: "Given the starting number of butterflies, what is the additional influence of our environmental predictors (e.g., wind, sun, temperature) on the abundance in the current time step?" This method allows us to statistically isolate the factors driving change between observations without creating a problematic response variable. It serves as more robust alternative for accounting autocorrelation than AR1.

To identify the most relevant aspect of wind, we will test a suite of continuous wind metrics, mean wind speed (sustained wind), maximum wind speed (peak gusts), and wind speed variance (gustiness), in separate models to avoid issues with collinearity. We will then use a model selection criterion, such as the Akaike Information Criterion (AICc), to compare these models. To ensure valid comparisons, the random effects structure will be held constant across all models. This entire analytical process will be repeated across multiple temporal scales (e.g., 30-minute, 4-hour, and daily) to investigate whether the disruptive effects of wind are due to immediate behavioral responses to acute events or cumulative responses to sustained conditions over longer durations. These scales were chosen to capture a range of potential biological responses, from short-term behavioral adjustments (30-minute) to responses to prolonged weather patterns (4-hour and daily), though the final scales may be adjusted based on data exploration.

\begin{verbatim}
# Example model for one wind metric (run separately for each)
model_max_wind <- glmer(
    abundance_index_t ~ abundance_index_t_minus_1 + 
                        max_wind_speed + 
                        sunlight_exposure_prop * ambient_temp +
                        (1 | view/labeler),
    family = "nbinom2",
    data = monarch_data
)
\end{verbatim}

If this general model reveals that one or more wind metrics are significant predictors, we will proceed to the final step.

\subsubsection{Step 3: Predictive Roost Abandonment Model}

If we establish a significant relationship in Step 2, our final step will be to build a predictive roost abandonment model. Using a mixed-effects logistic regression model, we will predict the probability of a roost abandonment event (e.g., a drop in abundance exceeding a high threshold, such as >90\%, to be finalized after data exploration), coded as a binary variable `roost_abandoned`. This model will use the most influential wind metric from Step 2 as the primary predictor.

\begin{verbatim}
% Load required library
library(lme4)

# Model: Predictive Hazard Analysis
hazard_model <- glmer(
    roost_abandoned ~ max_wind_speed + 
                      sunlight_exposure_prop * ambient_temp,
    family = binomial, # Specifies logistic regression
    data = monarch_data,
    control = glmerControl(optimizer = "bobyqa")
)
\end{verbatim}

The goal is to produce a probabilistic curve that quantifies the risk of roost abandonment across a range of wind speeds, providing a nuanced tool for habitat managers.